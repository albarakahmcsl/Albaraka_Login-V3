import{c as B,d as I,r as m,R as Q,j as e,o as j,F as U,p as b,g as v,q as g,n as z}from"./index-By7WQQ8B.js";import{u as S,a as N,P as F,S as G,T as H}from"./trash-2-CXVg9wSM.js";import{D as $}from"./dollar-sign-C3Nt5lMK.js";import{S as J}from"./square-pen-BTU3_gDf.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=B("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);function se(){const l=I(),[d,h]=m.useState(""),[c,a]=m.useState(!1),[i,n]=m.useState(!1),[s,r]=m.useState(null),[o,u]=m.useState(null),[f,x]=m.useState(null);Q.useEffect(()=>{if(o||f){const t=setTimeout(()=>{u(null),x(null)},5e3);return()=>clearTimeout(t)}},[o,f]);const{data:y,isLoading:L}=S({queryKey:g.accountTypes(),queryFn:b.getAccountTypes}),{data:_}=S({queryKey:g.bankAccounts(),queryFn:z.getBankAccounts}),k=N({mutationFn:b.createAccountType,onSuccess:()=>{x("Account type created successfully"),u(null),a(!1),l.invalidateQueries({queryKey:g.accountTypes()})},onError:t=>{u(t instanceof v?t.message:"Failed to create account type"),x(null)}}),w=N({mutationFn:({accountTypeId:t,accountTypeData:p})=>b.updateAccountType(t,p),onSuccess:()=>{x("Account type updated successfully"),u(null),n(!1),r(null),l.invalidateQueries({queryKey:g.accountTypes()})},onError:t=>{u(t instanceof v?t.message:"Failed to update account type"),x(null)}}),A=N({mutationFn:b.deleteAccountType,onSuccess:()=>{x("Account type deleted successfully"),u(null),l.invalidateQueries({queryKey:g.accountTypes()})},onError:t=>{u(t instanceof v?t.message:"Failed to delete account type"),x(null)}}),D=t=>{k.mutate(t)},E=t=>{s&&w.mutate({accountTypeId:s.id,accountTypeData:t})},M=t=>{confirm("Are you sure you want to delete this account type? This action cannot be undone.")&&A.mutate(t)},T=(y==null?void 0:y.account_types)||[],C=(_==null?void 0:_.bank_accounts)||[],P=L||k.isPending||w.isPending||A.isPending,q=T.filter(t=>{var p;return t.name.toLowerCase().includes(d.toLowerCase())||t.description&&t.description.toLowerCase().includes(d.toLowerCase())||((p=t.bank_account)==null?void 0:p.name)&&t.bank_account.name.toLowerCase().includes(d.toLowerCase())});return e.jsxs("div",{className:"space-y-6 pt-24",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[e.jsx(j,{className:"h-7 w-7 text-emerald-600 mr-2"}),"Account Type Management"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Configure Islamic finance account types with specific rules and properties"})]}),e.jsxs("button",{onClick:()=>a(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Add Account Type"]})]}),o&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsx("p",{className:"text-red-800",children:o})}),f&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:e.jsx("p",{className:"text-green-800",children:f})}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(G,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",value:d,onChange:t=>h(t.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"Search account types..."})]}),e.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:P?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-600"})}):q.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(j,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No account types"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:d?"No account types match your search.":"Get started by creating a new account type."}),!d&&e.jsx("div",{className:"mt-6",children:e.jsxs("button",{onClick:()=>a(!0),className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Add Account Type"]})})]}):e.jsx("ul",{className:"divide-y divide-gray-200",children:q.map(t=>{var p;return e.jsx("li",{children:e.jsx("div",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-12 w-12",children:e.jsx("div",{className:"h-12 w-12 rounded-full bg-emerald-100 flex items-center justify-center",children:e.jsx(j,{className:"h-6 w-6 text-emerald-600"})})}),e.jsxs("div",{className:"ml-4 flex-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-lg font-medium text-gray-900",children:t.name}),e.jsxs("div",{className:"ml-3 flex items-center space-x-2",children:[e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.is_active?"Active":"Inactive"}),t.is_member_account&&e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Member Account"}),t.can_take_loan&&e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:"Loan Eligible"})]})]}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:t.description||"No description"}),e.jsxs("div",{className:"text-sm text-gray-600 mt-2 grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Bank Account:"})," ",(p=t.bank_account)==null?void 0:p.name]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx($,{className:"h-4 w-4 text-gray-400 mr-1"}),e.jsx("span",{className:"font-medium",children:"Processing Fee:"})," MUR ",t.processing_fee]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(O,{className:"h-4 w-4 text-gray-400 mr-1"}),e.jsx("span",{className:"font-medium",children:"Dividend Rate:"})," ",t.dividend_rate,"%"]}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(U,{className:"h-4 w-4 text-gray-400 mr-1 mt-0.5"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Required Documents:"}),t.documents_required&&t.documents_required.length>0?e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:t.documents_required.map((R,K)=>e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800",children:R},K))}):e.jsx("span",{className:"text-gray-500 text-sm",children:" None specified"})]})]})})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>{r(t),n(!0)},className:"inline-flex items-center p-2 border border-transparent rounded-full shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",title:"Edit account type",children:e.jsx(J,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>M(t.id),className:"inline-flex items-center p-2 border border-transparent rounded-full shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",title:"Delete account type",children:e.jsx(H,{className:"h-4 w-4"})})]})]})})},t.id)})})}),c&&e.jsx(V,{bankAccounts:C,onClose:()=>a(!1),onSubmit:D}),i&&s&&e.jsx(W,{accountType:s,bankAccounts:C,onClose:()=>{n(!1),r(null)},onSubmit:E})]})}function V({bankAccounts:l,onClose:d,onSubmit:h}){const[c,a]=m.useState({name:"",description:"",bank_account_id:"",processing_fee:0,is_member_account:!1,can_take_loan:!1,dividend_rate:0,is_active:!0,documents_required_text:""}),i=n=>{if(n.preventDefault(),!c.name.trim()||!c.bank_account_id)return;const s=c.documents_required_text.split(",").map(r=>r.trim()).filter(r=>r.length>0);h({name:c.name.trim(),description:c.description.trim()||void 0,bank_account_id:c.bank_account_id,processing_fee:c.processing_fee,is_member_account:c.is_member_account,can_take_loan:c.can_take_loan,dividend_rate:c.dividend_rate,is_active:c.is_active,documents_required:s})};return e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-20 mx-auto p-5 border w-[500px] shadow-lg rounded-md bg-white",children:e.jsxs("div",{className:"mt-3",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Create New Account Type"}),e.jsxs("form",{onSubmit:i,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Account Type Name"}),e.jsx("input",{type:"text",required:!0,value:c.name,onChange:n=>a(s=>({...s,name:n.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500",placeholder:"e.g., Hajj Account, Savings Account",maxLength:100})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("textarea",{value:c.description,onChange:n=>a(s=>({...s,description:n.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500",rows:3,placeholder:"Describe the purpose and features of this account type",maxLength:500})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Associated Bank Account"}),e.jsxs("select",{required:!0,value:c.bank_account_id,onChange:n=>a(s=>({...s,bank_account_id:n.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500",children:[e.jsx("option",{value:"",children:"Select a bank account"}),l.map(n=>e.jsxs("option",{value:n.id,children:[n.name," (",n.account_number,")"]},n.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Processing Fee (MUR)"}),e.jsx("input",{type:"number",min:"0",step:"0.01",value:c.processing_fee,onChange:n=>a(s=>({...s,processing_fee:parseFloat(n.target.value)||0})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Dividend Rate (%)"}),e.jsx("input",{type:"number",min:"0",max:"100",step:"0.01",value:c.dividend_rate,onChange:n=>a(s=>({...s,dividend_rate:parseFloat(n.target.value)||0})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500",placeholder:"0.00"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Required Documents"}),e.jsx("textarea",{value:c.documents_required_text,onChange:n=>a(s=>({...s,documents_required_text:n.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500",rows:3,placeholder:"Enter required documents separated by commas (e.g., ID Card, Birth Certificate, Proof of Address)",maxLength:500}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Separate multiple documents with commas. These will be required when opening this account type."})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"is_member_account",checked:c.is_member_account,onChange:n=>a(s=>({...s,is_member_account:n.target.checked})),className:"rounded border-gray-300 text-emerald-600 focus:ring-emerald-500"}),e.jsxs("label",{htmlFor:"is_member_account",className:"ml-2 text-sm text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Member Account"}),e.jsx("span",{className:"text-gray-500 block",children:"Account holders are considered institution members"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"can_take_loan",checked:c.can_take_loan,onChange:n=>a(s=>({...s,can_take_loan:n.target.checked})),className:"rounded border-gray-300 text-emerald-600 focus:ring-emerald-500"}),e.jsxs("label",{htmlFor:"can_take_loan",className:"ml-2 text-sm text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Loan Eligible"}),e.jsx("span",{className:"text-gray-500 block",children:"Account holders can apply for loans"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"is_active",checked:c.is_active,onChange:n=>a(s=>({...s,is_active:n.target.checked})),className:"rounded border-gray-300 text-emerald-600 focus:ring-emerald-500"}),e.jsxs("label",{htmlFor:"is_active",className:"ml-2 text-sm text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Active"}),e.jsx("span",{className:"text-gray-500 block",children:"Account type is available for new accounts"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:d,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:!c.name.trim()||!c.bank_account_id,className:"px-4 py-2 text-sm font-medium text-white bg-emerald-600 hover:bg-emerald-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",children:"Create Account Type"})]})]})]})})})}function W({accountType:l,bankAccounts:d,onClose:h,onSubmit:c}){const[a,i]=m.useState({name:l.name,description:l.description||"",bank_account_id:l.bank_account_id,processing_fee:l.processing_fee,is_member_account:l.is_member_account,can_take_loan:l.can_take_loan,dividend_rate:l.dividend_rate,is_active:l.is_active,documents_required_text:(l.documents_required||[]).join(", ")}),n=s=>{if(s.preventDefault(),!a.name.trim()||!a.bank_account_id)return;const r=a.documents_required_text.split(",").map(o=>o.trim()).filter(o=>o.length>0);c({name:a.name.trim(),description:a.description.trim()||void 0,bank_account_id:a.bank_account_id,processing_fee:a.processing_fee,is_member_account:a.is_member_account,can_take_loan:a.can_take_loan,dividend_rate:a.dividend_rate,is_active:a.is_active,documents_required:r})};return e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-20 mx-auto p-5 border w-[500px] shadow-lg rounded-md bg-white",children:e.jsxs("div",{className:"mt-3",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Edit Account Type"}),e.jsxs("form",{onSubmit:n,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Account Type Name"}),e.jsx("input",{type:"text",required:!0,value:a.name,onChange:s=>i(r=>({...r,name:s.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500",maxLength:100})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("textarea",{value:a.description,onChange:s=>i(r=>({...r,description:s.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500",rows:3,maxLength:500})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Associated Bank Account"}),e.jsxs("select",{required:!0,value:a.bank_account_id,onChange:s=>i(r=>({...r,bank_account_id:s.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500",children:[e.jsx("option",{value:"",children:"Select a bank account"}),d.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.account_number,")"]},s.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Processing Fee (MUR)"}),e.jsx("input",{type:"number",min:"0",step:"0.01",value:a.processing_fee,onChange:s=>i(r=>({...r,processing_fee:parseFloat(s.target.value)||0})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Dividend Rate (%)"}),e.jsx("input",{type:"number",min:"0",max:"100",step:"0.01",value:a.dividend_rate,onChange:s=>i(r=>({...r,dividend_rate:parseFloat(s.target.value)||0})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Required Documents"}),e.jsx("textarea",{value:a.documents_required_text,onChange:s=>i(r=>({...r,documents_required_text:s.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500",rows:3,maxLength:500,placeholder:"Enter required documents separated by commas"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Separate multiple documents with commas. These will be required when opening this account type."})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"edit_is_member_account",checked:a.is_member_account,onChange:s=>i(r=>({...r,is_member_account:s.target.checked})),className:"rounded border-gray-300 text-emerald-600 focus:ring-emerald-500"}),e.jsxs("label",{htmlFor:"edit_is_member_account",className:"ml-2 text-sm text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Member Account"}),e.jsx("span",{className:"text-gray-500 block",children:"Account holders are considered institution members"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"edit_can_take_loan",checked:a.can_take_loan,onChange:s=>i(r=>({...r,can_take_loan:s.target.checked})),className:"rounded border-gray-300 text-emerald-600 focus:ring-emerald-500"}),e.jsxs("label",{htmlFor:"edit_can_take_loan",className:"ml-2 text-sm text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Loan Eligible"}),e.jsx("span",{className:"text-gray-500 block",children:"Account holders can apply for loans"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"edit_is_active",checked:a.is_active,onChange:s=>i(r=>({...r,is_active:s.target.checked})),className:"rounded border-gray-300 text-emerald-600 focus:ring-emerald-500"}),e.jsxs("label",{htmlFor:"edit_is_active",className:"ml-2 text-sm text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Active"}),e.jsx("span",{className:"text-gray-500 block",children:"Account type is available for new accounts"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:h,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:!a.name.trim()||!a.bank_account_id,className:"px-4 py-2 text-sm font-medium text-white bg-emerald-600 hover:bg-emerald-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",children:"Update Account Type"})]})]})]})})})}export{se as AdminAccountTypes};
