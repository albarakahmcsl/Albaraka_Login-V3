import{e as D,r as u,R as F,j as e,m as y,n as f,i as j,q as h}from"./index-BM4y656w.js";import{u as T}from"./useQuery-KF-a3XrY.js";import{u as N,P as C,S as P,T as K}from"./trash-2-BUyZlzLT.js";import{S as Q}from"./square-pen-pqQ883ti.js";function H(){const l=D(),[r,s]=u.useState(""),[n,c]=u.useState(!1),[o,a]=u.useState(!1),[d,g]=u.useState(null),[x,i]=u.useState(null),[b,m]=u.useState(null);F.useEffect(()=>{if(x||b){const t=setTimeout(()=>{i(null),m(null)},5e3);return()=>clearTimeout(t)}},[x,b]);const{data:p,isLoading:S}=T({queryKey:h.bankAccounts(),queryFn:f.getBankAccounts}),v=N({mutationFn:f.createBankAccount,onSuccess:()=>{m("Bank account created successfully"),i(null),c(!1),l.invalidateQueries({queryKey:h.bankAccounts()})},onError:t=>{i(t instanceof j?t.message:"Failed to create bank account"),m(null)}}),k=N({mutationFn:({bankAccountId:t,bankAccountData:L})=>f.updateBankAccount(t,L),onSuccess:()=>{m("Bank account updated successfully"),i(null),a(!1),g(null),l.invalidateQueries({queryKey:h.bankAccounts()})},onError:t=>{i(t instanceof j?t.message:"Failed to update bank account"),m(null)}}),w=N({mutationFn:f.deleteBankAccount,onSuccess:()=>{m("Bank account deleted successfully"),i(null),l.invalidateQueries({queryKey:h.bankAccounts()})},onError:t=>{i(t instanceof j?t.message:"Failed to delete bank account"),m(null)}}),B=t=>{v.mutate(t)},_=t=>{d&&k.mutate({bankAccountId:d.id,bankAccountData:t})},q=t=>{confirm("Are you sure you want to delete this bank account? This action cannot be undone.")&&w.mutate(t)},E=(p==null?void 0:p.bank_accounts)||[],M=S||v.isPending||k.isPending||w.isPending,A=E.filter(t=>t.name.toLowerCase().includes(r.toLowerCase())||t.account_number.toLowerCase().includes(r.toLowerCase()));return e.jsxs("div",{className:"space-y-6 pt-24",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[e.jsx(y,{className:"h-7 w-7 text-emerald-600 mr-2"}),"Bank Account Management"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Manage bank accounts for financial operations"})]}),e.jsxs("button",{onClick:()=>c(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500",children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),"Add Bank Account"]})]}),x&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsx("p",{className:"text-red-800",children:x})}),b&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:e.jsx("p",{className:"text-green-800",children:b})}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(P,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",value:r,onChange:t=>s(t.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"Search bank accounts..."})]}),e.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:M?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-600"})}):A.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(y,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No bank accounts"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:r?"No bank accounts match your search.":"Get started by creating a new bank account."}),!r&&e.jsx("div",{className:"mt-6",children:e.jsxs("button",{onClick:()=>c(!0),className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500",children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),"Add Bank Account"]})})]}):e.jsx("ul",{className:"divide-y divide-gray-200",children:A.map(t=>e.jsx("li",{children:e.jsxs("div",{className:"px-4 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-emerald-100 flex items-center justify-center",children:e.jsx(y,{className:"h-5 w-5 text-emerald-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Account Number: ",t.account_number]}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Created: ",new Date(t.created_at).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>{g(t),a(!0)},className:"inline-flex items-center p-2 border border-transparent rounded-full shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",title:"Edit bank account",children:e.jsx(Q,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>q(t.id),className:"inline-flex items-center p-2 border border-transparent rounded-full shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",title:"Delete bank account",children:e.jsx(K,{className:"h-4 w-4"})})]})]})},t.id))})}),n&&e.jsx(R,{onClose:()=>c(!1),onSubmit:B}),o&&d&&e.jsx(z,{bankAccount:d,onClose:()=>{a(!1),g(null)},onSubmit:_})]})}function R({onClose:l,onSubmit:r}){const[s,n]=u.useState({name:"",account_number:""}),c=o=>{o.preventDefault(),!(!s.name.trim()||!s.account_number.trim())&&r({name:s.name.trim(),account_number:s.account_number.trim()})};return e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:e.jsxs("div",{className:"mt-3",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Create New Bank Account"}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Account Name"}),e.jsx("input",{type:"text",required:!0,value:s.name,onChange:o=>n(a=>({...a,name:o.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500",placeholder:"e.g., Main Operating Account",maxLength:100})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Account Number"}),e.jsx("input",{type:"text",required:!0,value:s.account_number,onChange:o=>n(a=>({...a,account_number:o.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500",placeholder:"e.g., 1234567890",maxLength:50})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:l,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:!s.name.trim()||!s.account_number.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-emerald-600 hover:bg-emerald-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",children:"Create Account"})]})]})]})})})}function z({bankAccount:l,onClose:r,onSubmit:s}){const[n,c]=u.useState({name:l.name,account_number:l.account_number}),o=a=>{a.preventDefault(),!(!n.name.trim()||!n.account_number.trim())&&s({name:n.name.trim(),account_number:n.account_number.trim()})};return e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:e.jsxs("div",{className:"mt-3",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Edit Bank Account"}),e.jsxs("form",{onSubmit:o,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Account Name"}),e.jsx("input",{type:"text",required:!0,value:n.name,onChange:a=>c(d=>({...d,name:a.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500",maxLength:100})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Account Number"}),e.jsx("input",{type:"text",required:!0,value:n.account_number,onChange:a=>c(d=>({...d,account_number:a.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500",maxLength:50})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:!n.name.trim()||!n.account_number.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-emerald-600 hover:bg-emerald-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",children:"Update Account"})]})]})]})})})}export{H as AdminBankAccounts};
